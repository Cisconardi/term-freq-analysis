from collections import Counter
from pandas import *
import pandas as pd
import csv
new = []
num = []
# reading CSV file
data = read_csv("source.csv")

# converting column data to list
lst = data['Query'].tolist()
num = data['Impressioni'].tolist()
i = 0
num = [int(num) for num in num]

for string in lst:
  #print(num[i])
  #terms = string.split()
  #print(s lo tring.split())
  for k in range(num[i]):
    terms = string.split()
    #print(terms)
    new.extend(terms)
    #print(new)
    val = Counter(new)
  #print(val)
  if i <= len(num):
    i += 1
  #print(a)

with open('newfile.csv', encoding='utf-8-sig', mode='w') as fp:
    fp.write('query,freq\n')  
    for tag, count in Counter.items(val):  
        fp.write('{},{}\n'.format(tag, count)) 
